function findSmallestCircle(e){var t=e.slice(0);for(var n=e.length-1;n>=0;n--){var r=Math.floor(Math.random()*(n+1));r=Math.max(Math.min(r,n),0);var i=t[n];t[n]=t[r],t[r]=i}var s=null;for(var n=0;n<t.length;n++){var o=t[n];if(s==null||!isInCircle(s,o))s=makeCircleOnePoint(t.slice(0,n+1),o)}return s}function makeCircleOnePoint(e,t){var n={x:t.x,y:t.y,r:0};for(var r=0;r<e.length;r++){var i=e[r];isInCircle(n,i)||(n.r==0?n=makeDiameter(t,i):n=makeCircleTwoPoints(e.slice(0,r+1),t,i))}return n}function makeCircleTwoPoints(e,t,n){var r=makeDiameter(t,n),i=!0;for(var s=0;s<e.length;s++)i=i&&isInCircle(r,e[s]);if(i)return r;var o=null,u=null;for(var s=0;s<e.length;s++){var a=e[s],f=crossProduct(t.x,t.y,n.x,n.y,a.x,a.y),l=makeCircumcircle(t,n,a);if(l==null)continue;f>0&&(o==null||crossProduct(t.x,t.y,n.x,n.y,l.x,l.y)>crossProduct(t.x,t.y,n.x,n.y,o.x,o.y))?o=l:f<0&&(u==null||crossProduct(t.x,t.y,n.x,n.y,l.x,l.y)<crossProduct(t.x,t.y,n.x,n.y,u.x,u.y))&&(u=l)}return u==null||o!=null&&o.r<=u.r?o:u}function makeCircumcircle(e,t,n){var r=e.x,i=e.y,s=t.x,o=t.y,u=n.x,a=n.y,f=(r*(o-a)+s*(a-i)+u*(i-o))*2;if(f==0)return null;var l=((r*r+i*i)*(o-a)+(s*s+o*o)*(a-i)+(u*u+a*a)*(i-o))/f,c=((r*r+i*i)*(u-s)+(s*s+o*o)*(r-u)+(u*u+a*a)*(s-r))/f;return{x:l,y:c,r:distance(l,c,r,i)}}function makeDiameter(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2,r:distance(e.x,e.y,t.x,t.y)/2}}function isInCircle(e,t){return e!=null&&distance(t.x,t.y,e.x,e.y)<e.r+EPSILON}function crossProduct(e,t,n,r,i,s){return(n-e)*(s-t)-(r-t)*(i-e)}function distance(e,t,n,r){return Math.sqrt((e-n)*(e-n)+(t-r)*(t-r))}function defineClusters(e,t,n){function u(e,t){var n=0;return n+=Math.pow(t.x-e.x,2),n+=Math.pow(t.y-e.y,2),Math.sqrt(n)}function l(e){function n(e,r){if(Object(e)!==e)result[r]=e;else{var i=!0;for(var s in e)i=!1,s==="left"||s==="right"?n(e[s],""):s==="value"&&t.push(e[s]);i&&r&&(result[r]={})}}var t=[];return n(e,""),t}var r=jbone(".container");if(r.length===0){console.error("CLUSTERS ERROR- DOM Selector for your containment did not work! Try again.");return}var i=r[0].getBoundingClientRect(),s=i.width,o=i.height,a=n?n:Math.min(s/3,110),f=clusterfck.hcluster(JSON.parse(JSON.stringify(e)),u,"complete",a);return f=f.map(function(e){var t={points:l(e)};if(t.points.length>1){t.circle=findSmallestCircle(t.points);var n=[0,0,0,0];s-t.circle.x<t.circle.r*2.5&&(n[1]=1),t.circle.x<t.circle.r*2.5&&(n[3]=1),t.circle.y<t.circle.r*2.5&&(n[0]=1),o-t.circle.y<t.circle.r*2.5&&(n[2]=1),n=n.join(" "),n.indexOf("1")>-1&&(t.adjusted={},t.adjusted.circle={});switch(n){case"1 0 0 0":console.log("top collision!"),t.adjusted.circle.r=t.circle.y+t.circle.r,t.adjusted.circle.x=t.circle.x,t.adjusted.circle.y=0;break;case"0 1 0 0":console.log("right collision!"),t.adjusted.circle.r=s-(t.circle.x-t.circle.r),t.adjusted.circle.x=s,t.adjusted.circle.y=t.circle.y;break;case"0 0 1 0":console.log("bottom collision!"),t.adjusted.circle.r=o-(t.circle.y-t.circle.r),t.adjusted.circle.x=t.circle.x,t.adjusted.circle.y=o;break;case"0 0 0 1":console.log("left collision!"),t.adjusted.circle.r=t.circle.x+t.circle.r,t.adjusted.circle.x=0,t.adjusted.circle.y=t.circle.y;break;case"1 1 0 0":console.log("top right collision!");var r={};r.x=t.circle.x+t.circle.r*Math.cos(3*Math.PI/4),r.y=t.circle.y+t.circle.r*Math.sin(3*Math.PI/4),t.adjusted.circle.x=s,t.adjusted.circle.y=0,t.adjusted.circle.r=Math.round(u({x:t.adjusted.circle.x,y:t.adjusted.circle.y},r));break;case"1 0 0 1":console.log("top left collision!");var r={};r.x=t.circle.x+t.circle.r*Math.cos(Math.PI/4),r.y=t.circle.y+t.circle.r*Math.sin(Math.PI/4),t.adjusted.circle.x=0,t.adjusted.circle.y=0,t.adjusted.circle.r=Math.round(u({x:t.adjusted.circle.x,y:t.adjusted.circle.y},r));break;case"0 1 1 0":console.log("bottom right collision!");var r={};r.x=t.circle.x+t.circle.r*Math.cos(5*Math.PI/4),r.y=t.circle.y+t.circle.r*Math.sin(5*Math.PI/4),t.adjusted.circle.x=s,t.adjusted.circle.y=o,t.adjusted.circle.r=Math.round(u({x:t.adjusted.circle.x,y:t.adjusted.circle.y},r));break;case"0 0 1 1":console.log("bottom left collision!");var r={};r.x=t.circle.x+t.circle.r*Math.cos(7*Math.PI/4),r.y=t.circle.y+t.circle.r*Math.sin(7*Math.PI/4),t.adjusted.circle.x=0,t.adjusted.circle.y=o,t.adjusted.circle.r=Math.round(u({x:t.adjusted.circle.x,y:t.adjusted.circle.y},r))}function i(e,t,n){e.label={};var r=Math.atan2(e.y-t.y,e.x-t.x);r<0&&(r=2*Math.PI+r),r<=3*Math.PI/8||r>=13*Math.PI/8?e.label.position="right":r>3*Math.PI/8&&r<6*Math.PI/8?e.label.position="bottom":r>=6*Math.PI/8&&r<12*Math.PI/8?e.label.position="left":r>=12*Math.PI/8&&r<13*Math.PI/8&&(e.label.position="top");var i=10;return n&&(i=0),e.label.angle=r,e.label.x=t.x+(t.r+i)*Math.cos(r),e.label.y=t.y+(t.r+i)*Math.sin(r),e}t.points=t.points.map(function(e){return t.adjusted?i(e,t.adjusted.circle):i(e,t.circle)})}else t.points=t.points.map(function(e){var t={};return t.x=s-e.x<150?e.x+1:e.x-1,t.y=e.y,t.r=1,i(e,t,!0)});return t}),f}!function(e){function t(t){var n=t.length,r=typeof t;return d(r)||t===e?!1:1===t.nodeType&&n?!0:v(r)||0===n||"number"==typeof n&&n>0&&n-1 in t}function n(e,t){var n,r;this.originalEvent=e,r=function(e,t){this[e]="preventDefault"===e?function(){return this.defaultPrevented=!0,t[e]()}:"stopImmediatePropagation"===e?function(){return this.immediatePropagationStopped=!0,t[e]()}:d(t[e])?function(){return t[e]()}:t[e]};for(n in e)(e[n]||"function"==typeof e[n])&&r.call(this,n,e);m.extend(this,t,{isImmediatePropagationStopped:function(){return!!this.immediatePropagationStopped}})}var r,i=e.jbone,s=e.jBone,o=/^<(\w+)\s*\/?>jbone/,u=/^(?:[^#<]*(<[\w\W]+>)[^>]*jbone|#([\w\-]*)jbone)/,a=[].slice,f=[].splice,l=Object.keys,c=document,h=function(e){return"string"==typeof e},p=function(e){return e instanceof Object},d=function(e){return"[object Function]"==={}.toString.call(e)},v=function(e){return Array.isArray(e)},m=function(e,t){return new r.init(e,t)};m.noConflict=function(){return e.jbone=i,e.jBone=s,m},r=m.fn=m.prototype={init:function(e,t){var n,r,i,s;if(!e)return this;if(h(e)){if(r=o.exec(e))return this[0]=c.createElement(r[1]),this.length=1,p(t)&&this.attr(t),this;if((r=u.exec(e))&&r[1]){for(s=c.createDocumentFragment(),i=c.createElement("div"),i.innerHTML=e;i.lastChild;)s.appendChild(i.firstChild);return n=a.call(s.childNodes),m.merge(this,n)}if(m.isElement(t))return m(t).find(e);try{return n=c.querySelectorAll(e),m.merge(this,n)}catch(f){return this}}return e.nodeType?(this[0]=e,this.length=1,this):d(e)?e():e instanceof m?e:m.makeArray(e,this)},pop:[].pop,push:[].push,reverse:[].reverse,shift:[].shift,sort:[].sort,splice:[].splice,slice:[].slice,indexOf:[].indexOf,forEach:[].forEach,unshift:[].unshift,concat:[].concat,join:[].join,every:[].every,some:[].some,filter:[].filter,map:[].map,reduce:[].reduce,reduceRight:[].reduceRight,length:0},r.constructor=m,r.init.prototype=r,m.setId=function(t){var n=t.jid;t===e?n="window":void 0===t.jid&&(t.jid=n=++m._cache.jid),m._cache.events[n]||(m._cache.events[n]={})},m.getData=function(t){t=t instanceof m?t[0]:t;var n=t===e?"window":t.jid;return{jid:n,events:m._cache.events[n]}},m.isElement=function(e){return e&&e instanceof m||e instanceof HTMLElement||h(e)},m._cache={events:{},jid:0},r.pushStack=function(e){var t=m.merge(this.constructor(),e);return t},m.merge=function(e,t){for(var n=t.length,r=e.length,i=0;n>i;)e[r++]=t[i++];return e.length=r,e},m.contains=function(e,t){return e.contains(t)},m.extend=function(e){var t;return f.call(arguments,1).forEach(function(n){if(t=e,n)for(var r in n)t[r]=n[r]}),e},m.makeArray=function(e,n){var r=n||[];return null!==e&&(t(e)?m.merge(r,h(e)?[e]:e):r.push(e)),r},m.unique=function(e){if(null==e)return[];for(var t=[],n=0,r=e.length;r>n;n++){var i=e[n];t.indexOf(i)<0&&t.push(i)}return t},m.Event=function(e,t){var n,r;return e.type&&!t&&(t=e,e=e.type),n=e.split(".").splice(1).join("."),r=e.split(".")[0],e=c.createEvent("Event"),e.initEvent(r,!0,!0),m.extend(e,{namespace:n,isDefaultPrevented:function(){return e.defaultPrevented}},t)},m.event={add:function(e,t,n,r,i){m.setId(e);var s,o,u,a=function(t){m.event.dispatch.call(e,t)},f=m.getData(e).events;for(t=t.split(" "),o=t.length;o--;)u=t[o],s=u.split(".")[0],f[s]=f[s]||[],f[s].length||e.addEventListener&&e.addEventListener(s,a,!1),f[s].push({namespace:u.split(".").splice(1).join("."),fn:a,selector:i,data:r,originfn:n})},remove:function(e,t,n){var r,i,s=function(e,t,r,i,s){var o;(n&&s.originfn===n||!n)&&(o=s.fn),e[t][r].fn===o&&(e[t].splice(r,1),e[t].length||i.removeEventListener(t,o))},o=m.getData(e).events;if(o)return!t&&o?l(o).forEach(function(t){for(i=o[t],r=i.length;r--;)s(o,t,r,e,i[r])}):void t.split(" ").forEach(function(t){var n,u=t.split(".")[0],a=t.split(".").splice(1).join(".");if(o[u])for(i=o[u],r=i.length;r--;)n=i[r],(!a||a&&n.namespace===a)&&s(o,u,r,e,n);else a&&l(o).forEach(function(t){for(i=o[t],r=i.length;r--;)n=i[r],n.namespace.split(".")[0]===a.split(".")[0]&&s(o,t,r,e,n)})})},trigger:function(e,t){var n=[];h(t)?n=t.split(" ").map(function(e){return m.Event(e)}):(t=t instanceof Event?t:m.Event(t),n=[t]),n.forEach(function(t){t.type&&e.dispatchEvent&&e.dispatchEvent(t)})},dispatch:function(e){for(var t,r,i,s,o,u=0,a=0,f=this,l=m.getData(f).events[e.type],c=l.length,h=[],p=[];c>u;u++)h.push(l[u]);for(u=0,c=h.length;c>u&&~l.indexOf(h[u])&&(!s||!s.isImmediatePropagationStopped());u++)if(r=null,o={},i=h[u],i.data&&(o.data=i.data),i.selector){if(~(p=m(f).find(i.selector)).indexOf(e.target)&&(r=e.target)||f!==e.target&&f.contains(e.target)){if(!r)for(t=p.length,a=0;t>a;a++)p[a]&&p[a].contains(e.target)&&(r=p[a]);if(!r)continue;o.currentTarget=r,s=new n(e,o),e.namespace&&e.namespace!==i.namespace||i.originfn.call(r,s)}}else s=new n(e,o),e.namespace&&e.namespace!==i.namespace||i.originfn.call(f,s)}},r.on=function(e,t,n,r){var i=this.length,s=0;if(null==n&&null==r?(r=t,n=t=void 0):null==r&&("string"==typeof t?(r=n,n=void 0):(r=n,n=t,t=void 0)),!r)return this;for(;i>s;s++)m.event.add(this[s],e,r,n,t);return this},r.one=function(e){var t,n=arguments,r=0,i=this.length,s=a.call(n,1,n.length-1),o=a.call(n,-1)[0];for(t=function(t){var n=m(t);e.split(" ").forEach(function(e){var r=function(i){n.off(e,r),o.call(t,i)};n.on.apply(n,[e].concat(s,r))})};i>r;r++)t(this[r]);return this},r.trigger=function(e){var t=0,n=this.length;if(!e)return this;for(;n>t;t++)m.event.trigger(this[t],e);return this},r.off=function(e,t){for(var n=0,r=this.length;r>n;n++)m.event.remove(this[n],e,t);return this},r.find=function(e){for(var t=[],n=0,r=this.length,i=function(n){d(n.querySelectorAll)&&[].forEach.call(n.querySelectorAll(e),function(e){t.push(e)})};r>n;n++)i(this[n]);return m(t)},r.get=function(e){return null!=e?0>e?this[e+this.length]:this[e]:a.call(this)},r.eq=function(e){return m(this[e])},r.parent=function(){for(var e,t=[],n=0,r=this.length;r>n;n++)!~t.indexOf(e=this[n].parentElement)&&e&&t.push(e);return m(t)},r.toArray=function(){return a.call(this)},r.is=function(){var e=arguments;return this.some(function(t){return t.tagName.toLowerCase()===e[0]})},r.has=function(){var e=arguments;return this.some(function(t){return t.querySelectorAll(e[0]).length})},r.add=function(e,t){return this.pushStack(m.unique(m.merge(this.get(),m(e,t))))},r.attr=function(e,t){var n,r=arguments,i=0,s=this.length;if(h(e)&&1===r.length)return this[0]&&this[0].getAttribute(e);for(2===r.length?n=function(n){n.setAttribute(e,t)}:p(e)&&(n=function(t){l(e).forEach(function(n){t.setAttribute(n,e[n])})});s>i;i++)n(this[i]);return this},r.removeAttr=function(e){for(var t=0,n=this.length;n>t;t++)this[t].removeAttribute(e);return this},r.val=function(e){var t=0,n=this.length;if(0===arguments.length)return this[0]&&this[0].value;for(;n>t;t++)this[t].value=e;return this},r.css=function(t,n){var r,i=arguments,s=0,o=this.length;if(h(t)&&1===i.length)return this[0]&&e.getComputedStyle(this[0])[t];for(2===i.length?r=function(e){e.style[t]=n}:p(t)&&(r=function(e){l(t).forEach(function(n){e.style[n]=t[n]})});o>s;s++)r(this[s]);return this},r.data=function(e,t){var n,r=arguments,i={},s=0,o=this.length,u=function(e,t,n){p(n)?(e.jdata=e.jdata||{},e.jdata[t]=n):e.dataset[t]=n},a=function(e){return"true"===e?!0:"false"===e?!1:e};if(0===r.length)return this[0].jdata&&(i=this[0].jdata),l(this[0].dataset).forEach(function(e){i[e]=a(this[0].dataset[e])},this),i;if(1===r.length&&h(e))return this[0]&&a(this[0].dataset[e]||this[0].jdata&&this[0].jdata[e]);for(1===r.length&&p(e)?n=function(t){l(e).forEach(function(n){u(t,n,e[n])})}:2===r.length&&(n=function(n){u(n,e,t)});o>s;s++)n(this[s]);return this},r.removeData=function(e){for(var t,n,r=0,i=this.length;i>r;r++)if(t=this[r].jdata,n=this[r].dataset,e)t&&t[e]&&delete t[e],delete n[e];else{for(e in t)delete t[e];for(e in n)delete n[e]}return this},r.addClass=function(e){for(var t=0,n=0,r=this.length,i=e?e.trim().split(/\s+/):[];r>t;t++)for(n=0,n=0;n<i.length;n++)this[t].classList.add(i[n]);return this},r.removeClass=function(e){for(var t=0,n=0,r=this.length,i=e?e.trim().split(/\s+/):[];r>t;t++)for(n=0,n=0;n<i.length;n++)this[t].classList.remove(i[n]);return this},r.toggleClass=function(e,t){var n=0,r=this.length,i="toggle";if(t===!0&&(i="add")||t===!1&&(i="remove"),e)for(;r>n;n++)this[n].classList[i](e);return this},r.hasClass=function(e){var t=0,n=this.length;if(e)for(;n>t;t++)if(this[t].classList.contains(e))return!0;return!1},r.html=function(e){var t,n=arguments;return 1===n.length&&void 0!==e?this.empty().append(e):0===n.length&&(t=this[0])?t.innerHTML:this},r.append=function(e){var t,n=0,r=this.length;for(h(e)&&u.exec(e)?e=m(e):p(e)||(e=document.createTextNode(e)),e=e instanceof m?e:m(e),t=function(t,n){e.forEach(function(e){t.appendChild(n?e.cloneNode(!0):e)})};r>n;n++)t(this[n],n);return this},r.appendTo=function(e){return m(e).append(this),this},r.empty=function(){for(var e,t=0,n=this.length;n>t;t++)for(e=this[t];e.lastChild;)e.removeChild(e.lastChild);return this},r.remove=function(){var e,t=0,n=this.length;for(this.off();n>t;t++)e=this[t],delete e.jdata,e.parentNode&&e.parentNode.removeChild(e);return this},"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=m:"function"==typeof define&&define.amd?(define(function(){return m}),e.jBone=e.jbone=m):"object"==typeof e&&"object"==typeof e.document&&(e.jBone=e.jbone=m)}(window);var clusterfck=function(){var e=function(t,n){var r=e.resolve(t,n||"/"),i=e.modules[r];if(!i)throw new Error("Failed to resolve module "+t+", tried "+r);var s=i._cached?i._cached:i();return s};e.paths=[],e.modules={},e.extensions=[".js",".coffee"],e._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},e.resolve=function(){return function(t,n){function u(t){if(e.modules[t])return t;for(var n=0;n<e.extensions.length;n++){var r=e.extensions[n];if(e.modules[t+r])return t+r}}function a(t){t=t.replace(/\/+$/,"");var n=t+"/package.json";if(e.modules[n]){var i=e.modules[n](),s=i.browserify;if(typeof s=="object"&&s.main){var o=u(r.resolve(t,s.main));if(o)return o}else if(typeof s=="string"){var o=u(r.resolve(t,s));if(o)return o}else if(i.main){var o=u(r.resolve(t,i.main));if(o)return o}}return u(t+"/index")}function f(e,t){var n=l(t);for(var r=0;r<n.length;r++){var i=n[r],s=u(i+"/"+e);if(s)return s;var o=a(i+"/"+e);if(o)return o}var s=u(e);if(s)return s}function l(e){var t;e==="/"?t=[""]:t=r.normalize(e).split("/");var n=[];for(var i=t.length-1;i>=0;i--){if(t[i]==="node_modules")continue;var s=t.slice(0,i+1).join("/")+"/node_modules";n.push(s)}return n}n||(n="/");if(e._core[t])return t;var r=e.modules.path(),i=n||".";if(t.match(/^(?:\.\.?\/|\/)/)){var s=u(r.resolve(i,t))||a(r.resolve(i,t));if(s)return s}var o=f(t,i);if(o)return o;throw new Error("Cannot find module '"+t+"'")}}(),e.alias=function(n,r){var i=e.modules.path(),s=null;try{s=e.resolve(n+"/package.json","/")}catch(o){s=e.resolve(n,"/")}var u=i.dirname(s),a=t(e.modules);for(var f=0;f<a.length;f++){var l=a[f];if(l.slice(0,u.length+1)===u+"/"){var c=l.slice(u.length);e.modules[r+c]=e.modules[u+c]}else l===u&&(e.modules[r]=e.modules[u])}},e.define=function(t,n){var r=e._core[t]?"":e.modules.path().dirname(t),i=function(t){return e(t,r)};i.resolve=function(t){return e.resolve(t,r)},i.modules=e.modules,i.define=e.define;var s={exports:{}};e.modules[t]=function(){return e.modules[t]._cached=s.exports,n.call(s.exports,i,s,s.exports,r,t),e.modules[t]._cached=s.exports,s.exports}};var t=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};return typeof process=="undefined"&&(process={}),process.nextTick||(process.nextTick=function(e){setTimeout(e,0)}),process.title||(process.title="browser"),process.binding||(process.binding=function(t){if(t==="evals")return e("vm");throw new Error("No such module")}),process.cwd||(process.cwd=function(){return"."}),e.define("path",function(e,t,n,r,i){function s(e,t){var n=[];for(var r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}function o(e,t){var n=0;for(var r=e.length;r>=0;r--){var i=e[r];i=="."?e.splice(r,1):i===".."?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var u=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;n.resolve=function(){var e="",t=!1;for(var n=arguments.length;n>=-1&&!t;n--){var r=n>=0?arguments[n]:process.cwd();if(typeof r!="string"||!r)continue;e=r+"/"+e,t=r.charAt(0)==="/"}return e=o(s(e.split("/"),function(e){return!!e}),!t).join("/"),(t?"/":"")+e||"."},n.normalize=function(e){var t=e.charAt(0)==="/",n=e.slice(-1)==="/";return e=o(s(e.split("/"),function(e){return!!e}),!t).join("/"),!e&&!t&&(e="."),e&&n&&(e+="/"),(t?"/":"")+e},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(s(e,function(e,t){return e&&typeof e=="string"}).join("/"))},n.dirname=function(e){var t=u.exec(e)[1]||"",n=!1;return t?t.length===1||n&&t.length<=3&&t.charAt(1)===":"?t:t.substring(0,t.length-1):"."},n.basename=function(e,t){var n=u.exec(e)[2]||"";return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return u.exec(e)[3]||""}}),e.define("/clusterfck.js",function(e,t,n,r,i){t.exports={hcluster:e("./hcluster"),kmeans:e("./kmeans")}}),e.define("/hcluster.js",function(e,t,n,r,i){var s=e("./distance"),o=function(e,t,n){this.distance=e,this.linkage=t,this.threshold=n==undefined?Infinity:n};o.prototype={cluster:function(e,t,n){this.clusters=[],this.dists=[],this.mins=[],this.index=[];for(var r=0;r<e.length;r++){var i={value:e[r],key:r,index:r,size:1};this.clusters[r]=i,this.index[r]=i,this.dists[r]=[],this.mins[r]=0}for(var r=0;r<this.clusters.length;r++)for(var s=0;s<=r;s++){var o=r==s?Infinity:this.distance(this.clusters[r].value,this.clusters[s].value);this.dists[r][s]=o,this.dists[s][r]=o,o<this.dists[r][this.mins[r]]&&(this.mins[r]=s)}var u=this.mergeClosest(),r=0;while(u)n&&r++%t==0&&n(this.clusters),u=this.mergeClosest();return this.clusters.forEach(function(e){delete e.key,delete e.index}),this.clusters},mergeClosest:function(){var e=0,t=Infinity;for(var n=0;n<this.clusters.length;n++){var r=this.clusters[n].key,i=this.dists[r][this.mins[r]];i<t&&(e=r,t=i)}if(t>=this.threshold)return!1;var s=this.index[e],o=this.index[this.mins[e]],u={left:s,right:o,key:s.key,size:s.size+o.size};this.clusters[s.index]=u,this.clusters.splice(o.index,1),this.index[s.key]=u;for(var n=0;n<this.clusters.length;n++){var a=this.clusters[n],i;s.key==a.key?i=Infinity:this.linkage=="single"?(i=this.dists[s.key][a.key],this.dists[s.key][a.key]>this.dists[o.key][a.key]&&(i=this.dists[o.key][a.key])):this.linkage=="complete"?(i=this.dists[s.key][a.key],this.dists[s.key][a.key]<this.dists[o.key][a.key]&&(i=this.dists[o.key][a.key])):this.linkage=="average"?i=(this.dists[s.key][a.key]*s.size+this.dists[o.key][a.key]*o.size)/(s.size+o.size):i=this.distance(a.value,s.value),this.dists[s.key][a.key]=this.dists[a.key][s.key]=i}for(var n=0;n<this.clusters.length;n++){var f=this.clusters[n].key;if(this.mins[f]==s.key||this.mins[f]==o.key){var t=f;for(var l=0;l<this.clusters.length;l++){var c=this.clusters[l].key;this.dists[f][c]<this.dists[f][t]&&(t=c)}this.mins[f]=t}this.clusters[n].index=n}return delete s.key,delete o.key,delete s.index,delete o.index,!0}};var u=function(e,t,n,r,i,u){t=t||"euclidean",n=n||"average",typeof t=="string"&&(t=s[t]);var a=(new o(t,n,r)).cluster(e,i,u);return r===undefined?a[0]:a};t.exports=u}),e.define("/distance.js",function(e,t,n,r,i){t.exports={euclidean:function(e,t){var n=0;for(var r=0;r<e.length;r++)n+=Math.pow(t[r]-e[r],2);return Math.sqrt(n)},manhattan:function(e,t){var n=0;for(var r=0;r<e.length;r++)n+=Math.abs(t[r]-e[r]);return n},max:function(e,t){var n=0;for(var r=0;r<e.length;r++)n=Math.max(n,Math.abs(t[r]-e[r]));return n}}}),e.define("/kmeans.js",function(e,t,n,r,i){function o(e,t){var n=e.slice(0);return n.sort(function(){return Math.round(Math.random())-.5}),n.slice(0,t)}function u(e,t,n){var r=Infinity,i=0;for(var s=0;s<t.length;s++){var o=n(e,t[s]);o<r&&(r=o,i=s)}return i}function a(e,t,n,r,i){n=n||"euclidean",typeof n=="string"&&(n=s[n]);var a=o(e,t),f=new Array(e.length),l=new Array(t),c=0,h=!0;while(h){for(var p=0;p<e.length;p++)f[p]=u(e[p],a,n);h=!1;for(var d=0;d<t;d++){var v=[];f.forEach(function(t,n){t==d&&v.push(e[n])});if(!v.length)continue;var m=a[d],g=new Array(m.length);for(var y=0;y<m.length;y++){var b=0;for(var p=0;p<v.length;p++)b+=v[p][y];g[y]=b/v.length,g[y]!=m[y]&&(h=!0)}a[d]=g,l[d]=v}i&&c++%r==0&&i(l)}return l}var s=e("./distance");t.exports=a}),e("/clusterfck")}(),EPSILON=1e-12